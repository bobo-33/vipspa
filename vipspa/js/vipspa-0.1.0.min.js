!function(){function t(){}function e(t){var e=vipspa.routerMap[t.url];if("undefined"==typeof e){var a=vipspa.routerMap.defaults;return e=vipspa.routerMap[a],location.hash=a,!1}var o=i(e.templateUrl);o?n(e):r(e)}function r(t){$.ajax({type:"GET",url:t.templateUrl,dataType:"html",success:function(e,r,n){$(vipspa.mainView).html(e),u(t.controller),o(t.templateUrl,e)},error:function(t,e,r){if(0===$(vipspa.errorTemplateId).length)return!1;var n=$(vipspa.errorTemplateId).html();n=n.replace(/{{errStatus}}/,t.status),n=n.replace(/{{errContent}}/,t.responseText),$(vipspa.mainView).html(n)}})}function n(t){var e=a(t.templateUrl);$(vipspa.mainView).html(e),u(t.controller)}function a(t){for(var e,r=0;r<vipspa.catchHtmls.length;r++)if(e=vipspa.catchHtmls[r],e.routerUrl===t)return e.htmls;return""}function o(t,e){var r={routerUrl:t,htmls:e};vipspa.catchHtmls.push(r)}function i(t){for(var e,r=0;r<vipspa.catchHtmls.length;r++)if(e=vipspa.catchHtmls[r],e.routerUrl===t)return!0;return!1}function p(){var t=location.hash,r=vipspa.parse(t);e(r)}function u(t,e){var r,n=document.createElement("script");n.setAttribute("src",t),n.onreadystatechange=n.onload=function(){n.onreadystatechange=null,document.documentElement.removeChild(n),n=null,r||"function"==typeof e&&e(),r=!0},document.documentElement.appendChild(n)}t.prototype.start=function(t){var e=this;e.routerMap=t.router,e.mainView=t.view,e.errorTemplateId=t.errorTemplateId,e.catchHtmls=[],p(),window.onhashchange=function(){p()}};var s=[];t.prototype.getMessage=function(t){var e={};return $.each(s,function(r,n){n.id===t&&(e=n)}),e},t.prototype.setMessage=function(t){var e=JSON.parse(JSON.stringify(t));$.each(s,function(t,r){if(r.id===e.id)return r=e,!1}),s.push(e)},t.prototype.delMessage=function(t){if("undefined"==typeof t)return!1;var e=0;$.each(s,function(r,n){n.id===t&&(e=r)}),$.each(s,function(t,r){t>e&&(s[t-1]=r)})},t.prototype.clearMessage=function(t){s=[]},t.prototype.stringify=function(t,e){var r,n="";for(var a in e)n+=a+"="+encodeURIComponent(e[a])+"&";return""===n?r=t:(n=n.substring(0,n.length-1),r=t+"?"+n),r},t.prototype.parse=function(t){var e="undefined"==typeof t?location.hash:t,r={url:"",param:{}},n={},a="",o=e.indexOf("?");if(""===e)return r;if(o>-1){a=e.substring(1,o);var i=e.substring(o+1),p=i.split("&");$.each(p,function(t,e){var r,a,o=e.split("=");r=o[0],a=o[1],""!==r&&(n[r]=decodeURIComponent(a))})}else a=e.substring(1),n={};return{url:a,param:n}},window.vipspa=new t}();